 #!/bin/bash

/usr/bin/ruby <<-EORUBY
	
	def run_shell(cmd, path)
		ensure_dir(path) do
			puts "-> Changed wdir to #{Dir.pwd}"
			puts "-> Running command '#{cmd}'"

			system cmd	
		end


		$? == 0
	end

	def ensure_dir(path, &code)
		dir = Dir.pwd
		begin
			Dir.chdir path
			code.call
		ensure
			Dir.chdir dir
		end
	end

	load '.git/hooks/visual_merge_config.rb'
 
	run_shell "/usr/bin/env ruby git/register_merge.rb", VISUAL_MERGE_HOME
	
EORUBY
